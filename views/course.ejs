<%- include('header.ejs') %>
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
<div class="container">
    <h2 class="text-center my-4">Lecture Slides for <%= subject %></h2>

    <% if (slides.length === 0) { %>
        <p class="text-center text-muted">No slides available for this course.</p>
    <% } else { %>
        <ul class="list-group">
            <% slides.forEach((slide, index) => { %>
                <li class="list-group-item d-flex justify-content-between align-items-center slide-item">
                    Lecture <%= index + 1 %>: <%= slide.replace('.pdf', '') %>
                    <div class="d-flex">
                        <% if (subscription_type === 'Free' || subscription_type === 'Pro') { %>
                            <!-- Show Upgrade Popup for Free Plan Users -->
                            <a href="javascript:void(0);" class="btn btn-sm btn-primary" onclick="showUpgradePopup()">
                                <i class="bi bi-lightning-charge"></i>
                            </a>
                        <% } else { %>
                            <!-- Button to generate flashcards for Enterprise plans -->
                            <a href="/generateQuestions/<%= encodeURIComponent(slide) %>" class="btn btn-sm btn-primary">
                                <i class="bi bi-lightning-charge"></i>
                            </a>
                        <% } %>
                        <!-- Download button available to all subscription plans -->
                        <a href="/Course/<%= subject %>/slides/<%= encodeURIComponent(slide) %>" target="_blank" class="btn btn-sm btn-brown mr-2 download-btn">
                            <i class="bi bi-download"></i>
                        </a>
                        <!-- View in PDF Viewer button available to all subscription plans -->
                        <a href="/pdfview/<%= encodeURIComponent(slide) %>" class="btn btn-sm btn-primary view-btn">
                            <i class="bi bi-eye"></i>
                        </a>
                        <% if (subscription_type === 'Free'  || subscription_type === 'Pro') { %>
                            <!-- Show Upgrade Popup for Free Plan Users -->
                            <a href="javascript:void(0);" class="btn btn-sm btn-brown  summarize-btn" onclick="showUpgradePopup()">
                                <i class="bi bi-file-text"></i>
                            </a>
                        <% } else { %>
                            <!-- Summarize Notes button for Enterprise plans -->
                            <a href="/summarize/<%= encodeURIComponent(slide) %>" class="btn btn-sm btn-brown summarize-btn">
                                <i class="bi bi-file-text"></i>
                            </a>
                        <% } %>
                    </div>
                </li>
            <% }); %>
        </ul>
    <% } %>
</div>

<h2 class="text-center my-4">My Personal Slide Notes for <%= subject %></h2>
<% if (personalslides.length === 0) { %>
    <p class="text-center text-muted">No personal slides available for this course.</p>
<% } else { %>
    <ul class="list-group">
        <% personalslides.forEach((slide, index) => { %>
            <li class="list-group-item d-flex justify-content-between align-items-center">
                Lecture <%= index + 1 %>: <%= slide.replace('.pdf', '') %>
                <a href="/Workstation/<%= userid %>/<%= subject %>/slides/<%= encodeURIComponent(slide) %>" target="_blank" class="btn btn-sm btn-brown view-btn">
                    <i class="bi bi-eye"></i> View
                </a>
            </li>
        <% }); %>
    </ul>
<% } %>

<div class="container my-5">
    <h3 class="text-center">Upload Personal Notes</h3>
    <form action="/uploadPdf" method="POST" enctype="multipart/form-data" class="text-center">
        <input type="file" name="pdfFile" accept="application/pdf" class="form-control my-2" required>
        <button type="submit" class="btn btn-brown upload-btn">
            <i class="bi bi-upload"></i> Upload
        </button>
    </form>
</div>

<!-- Hidden popup for upgrade message -->
<div id="upgradePopup" class="popup">
    <div class="popup-content">
        <span class="popup-close" onclick="closePopup()">&times;</span>
        <h4>Upgrade for More Features</h4>
        <p>This feature is only available in higher subscription plans.</p>
    </div>
</div>

<!-- Script for handling the popup display -->
<script>
    function showUpgradePopup() {
        document.getElementById("upgradePopup").style.display = "block";
    }

    function closePopup() {
        document.getElementById("upgradePopup").style.display = "none";
    }
</script>

<style>
    /* Smooth transition for buttons */
    .generate-btn, .download-btn, .view-btn, .summarize-btn {
        transition: all 0.3s ease;
        border-radius: 5px;
    }
    /* Hover effects for buttons */
    .generate-btn:hover {
        background-color: #007bff;
        transform: scale(1.05);
    }
    .download-btn:hover {
        background-color: #8B4513;
        transform: scale(1.05);
    }
    .view-btn:hover {
        background-color: #007bff;
        transform: scale(1.05);
    }
    .summarize-btn:hover{
        background-color: #8B4513;
        transform: scale(1.05);
    }
    /* Adding animation for the "Generate Flashcards" button */
    .generate-btn {
        position: relative;
        display: inline-block;
        cursor: pointer;
    }
    .generate-btn:active {
        animation: flashcardsClick 0.5s ease-in-out forwards;
    }
    /* Animation when user clicks the "Generate Flashcards" button */
    @keyframes flashcardsClick {
        0% {
            transform: scale(1);
            opacity: 1;
        }
        50% {
            transform: scale(1.2);
            opacity: 0.8;
        }
        100% {
            transform: scale(1);
            opacity: 1;
        }
    }

    /* Popup styling */
    .popup {
        display: none;
        position: fixed;
        z-index: 1;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.4);
    }

    .popup-content {
        background-color: #fefefe;
        margin: 15% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
        max-width: 400px;
        text-align: center;
    }

    .popup-close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }

    .popup-close:hover,
    .popup-close:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
    }
</style>

<%- include('footer.ejs') %>
